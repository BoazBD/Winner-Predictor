{% extends "base.html" %}

{% block content %}
<div class="min-h-screen" style="background-color: #fafbfc;">
    <div class="container mx-auto px-4 py-6" style="max-width: 80rem;">
        {% if error_message %}
        <div class="alert" role="alert" style="background-color: #fff3cd; border: 1px solid #ffecb5; color: #856404; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
            <h4 style="margin: 0 0 0.5rem 0; font-weight: 600;">Index Required</h4>
            <p style="margin: 0 0 1rem 0;">{{ error_message }}</p>
            <hr style="margin: 1rem 0; border: none; border-top: 1px solid #ffecb5;">
            <p style="margin: 0;">Please create the required index in Firebase Console to enable this query.</p>
        </div>
        {% endif %}
        
        <!-- Header Section -->
        <div style="margin-bottom: 1.5rem;">
            <a href="/" style="text-decoration: none; color: #6b7280; display: inline-flex; align-items: center; margin-bottom: 1rem; padding: 0.25rem 0.5rem; border-radius: 0.375rem; transition: all 0.2s;">
                <svg style="width: 1rem; height: 1rem; margin-right: 0.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                Back to Home
            </a>
            
            <div style="display: flex; flex-direction: column; gap: 1rem; margin-bottom: 1.5rem;">
                <div style="display: flex; flex-direction: column; flex: 1;">
                    <h1 style="font-size: 1.875rem; font-weight: 700; color: #111827; margin: 0 0 0.5rem 0;">All Predictions</h1>
                    <p style="color: #6b7280; margin: 0;">Complete overview of AI-powered sports betting predictions</p>
                </div>
                
                <!-- Stats Header -->
                <div style="display: flex; gap: 2rem; justify-content: flex-start;">
                    <div style="text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: #111827;">{{ games|length if games else 0 }}</div>
                        <div style="font-size: 0.875rem; color: #6b7280;">Total</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: #059669;">
                            {% set profitable_count = games|selectattr('home_win_is_profitable')|list|length + games|selectattr('draw_is_profitable')|list|length + games|selectattr('away_win_is_profitable')|list|length if games else 0 %}
                            {{ profitable_count }}
                        </div>
                        <div style="font-size: 0.875rem; color: #6b7280;">Profitable</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: #dc2626;">{{ (games|length - profitable_count) if games else 0 }}</div>
                        <div style="font-size: 0.875rem; color: #6b7280;">Non-Profitable</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Compact Filter Bar -->
        <div style="background-color: white; border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1.5rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);">
            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                <svg style="width: 1rem; height: 1rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"></path>
                </svg>
                <span style="font-size: 0.875rem; font-weight: 500; color: #111827;">Filters</span>
                {% if selected_league or selected_model or selected_game_id %}
                <a href="/all?lang={{ selected_language|default('english') }}" style="margin-left: auto; padding: 0.125rem 0.5rem; font-size: 0.75rem; color: #6b7280; text-decoration: none; border: 1px solid #d1d5db; border-radius: 0.25rem; transition: all 0.2s;">
                    <svg style="width: 0.75rem; height: 0.75rem; display: inline; margin-right: 0.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                    Clear
                </a>
                {% endif %}
            </div>
            
            <form id="filterForm" method="GET" action="/all">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
                    <select name="model_type" style="height: 2.25rem; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; font-size: 0.875rem;">
                        <option value="">All Models</option>
                        {% for model in model_types %}
                        <option value="{{ model }}" {% if selected_model == model %}selected{% endif %}>{{ model }}</option>
                        {% endfor %}
                    </select>
                    
                    <select name="league" style="height: 2.25rem; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; font-size: 0.875rem;">
                        <option value="">All Leagues</option>
                        {% for league in leagues %}
                        <option value="{{ league }}" {% if selected_league == league %}selected{% endif %}>{{ league }}</option>
                        {% endfor %}
                    </select>
                    
                    <div style="position: relative;">
                        <svg style="position: absolute; left: 0.75rem; top: 50%; transform: translateY(-50%); width: 0.75rem; height: 0.75rem; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <input type="text" name="game_id" placeholder="Game ID" value="{{ selected_game_id|default('') }}" style="height: 2.25rem; padding: 0.5rem 0.5rem 0.5rem 2.25rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; font-size: 0.875rem; width: 100%;">
                    </div>
                    
                    <button type="submit" style="height: 2.25rem; padding: 0.5rem 1rem; background-color: #3b82f6; color: white; border: none; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                        Apply
                    </button>
                </div>
                <input type="hidden" name="lang" value="{{ selected_language|default('english') }}">
            </form>
        </div>

        <!-- Results Header -->
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
            <div style="display: flex; align-items: center; gap: 0.5rem;">
                <svg style="width: 1.25rem; height: 1.25rem; color: #3b82f6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
                <span style="font-weight: 500;">Predictions</span>
                <span style="font-size: 0.875rem; color: #6b7280;">â€¢ Sorted by match time</span>
            </div>
            
            <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; color: #6b7280;">
                <svg style="width: 1rem; height: 1rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                </svg>
                <span>EV = Expected Value</span>
            </div>
        </div>

        <!-- Loading spinner -->
        {% if loading %}
        <div id="loading-spinner" style="text-align: center; margin: 3rem 0;">
            <div style="display: inline-block; width: 2rem; height: 2rem; border: 3px solid #e5e7eb; border-radius: 50%; border-top-color: #3b82f6; animation: spin 1s ease-in-out infinite;"></div>
            <p style="margin-top: 1rem;">Loading predictions...</p>
        </div>
        {% endif %}
        
        <!-- Error message -->
        {% if error %}
        <div style="background-color: #fee2e2; border: 1px solid #fecaca; color: #b91c1c; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
            <svg style="width: 1rem; height: 1rem; display: inline; margin-right: 0.5rem;" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
            </svg>
            Error loading predictions. Please try again later.
        </div>
        {% endif %}
        
        <div id="predictions-container">
            {% if games %}
                <!-- No predictions message -->
                {% if games|length == 0 %}
                <div style="text-align: center; padding: 4rem 0;">
                    <svg style="width: 4rem; height: 4rem; margin: 0 auto 1rem; color: #d1d5db;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <h3 style="font-size: 1.125rem; font-weight: 500; color: #111827; margin: 0 0 0.5rem 0;">No predictions found</h3>
                    <p style="color: #6b7280; margin: 0;">Try adjusting your filters to see more results.</p>
                </div>
                {% else %}
                
                <!-- Predictions List -->
                <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                    {% for game in games %}
                    <div style="background-color: white; border: 1px solid #e5e7eb; border-radius: 0.5rem; transition: all 0.2s; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);" onmouseover="this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)'; this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 1px 3px 0 rgba(0, 0, 0, 0.1)'; this.style.transform='translateY(0)'">
                        
                        <!-- Mobile Layout -->
                        <div style="display: block; padding: 1rem;" class="mobile-layout">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.75rem;">
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="display: inline-block; padding: 0.125rem 0.5rem; background-color: #f3f4f6; color: #374151; border-radius: 0.25rem; font-size: 0.75rem;">
                                        {{ game.display_league|default(game.league|default('Unknown League')) }}
                                    </span>
                                    {% if game.home_win_is_profitable or game.draw_is_profitable or game.away_win_is_profitable %}
                                    <span style="display: inline-block; padding: 0.125rem 0.5rem; background-color: rgba(5, 150, 105, 0.1); color: #059669; border: 1px solid rgba(5, 150, 105, 0.2); border-radius: 0.25rem; font-size: 0.75rem;">
                                        Profitable
                                    </span>
                                    {% endif %}
                                </div>
                                <div style="font-size: 0.75rem; color: #6b7280;">
                                    {{ game.match_time.strftime('%b %d, %H:%M') }}
                                </div>
                            </div>
                            
                            <div style="text-align: center; margin-bottom: 0.75rem;">
                                <div style="font-weight: 600; color: #111827;">
                                    {{ game.display_home_team|default(game.home_team|default('Home Team')) }} vs {{ game.display_away_team|default(game.away_team|default('Away Team')) }}
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; text-align: center; margin-bottom: 0.75rem;">
                                <!-- Home -->
                                <div style="background-color: rgba(229, 231, 235, 0.3); border-radius: 0.375rem; padding: 0.5rem;">
                                    <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 0.25rem;">Home</div>
                                    <div style="font-weight: 600; font-size: 0.875rem;">{{ game.odds.home if game.odds.home else '-' }}</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">{{ (game.home_win_prob * 100)|round(0) if game.home_win_prob else '-' }}%</div>
                                    <div style="width: 100%; height: 1.25rem; font-size: 0.75rem; margin-top: 0.25rem; border-radius: 0.25rem; display: flex; align-items: center; justify-content: center; font-weight: 500; 
                                        {% if game.home_win_ev and game.home_win_ev > 0 %}background-color: #059669; color: white;
                                        {% elif game.home_win_ev and game.home_win_ev < 0 %}background-color: #dc2626; color: white;
                                        {% else %}background-color: #eab308; color: white;{% endif %}">
                                        {% if game.home_win_ev %}{{ '+' if game.home_win_ev >= 0 else '' }}{{ (game.home_win_ev * 100)|round(1) }}%{% else %}-{% endif %}
                                    </div>
                                </div>
                                
                                <!-- Draw -->
                                <div style="background-color: rgba(229, 231, 235, 0.3); border-radius: 0.375rem; padding: 0.5rem;">
                                    <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 0.25rem;">Draw</div>
                                    <div style="font-weight: 600; font-size: 0.875rem;">{{ game.odds.draw if game.odds.draw else '-' }}</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">{{ (game.draw_prob * 100)|round(0) if game.draw_prob else '-' }}%</div>
                                    <div style="width: 100%; height: 1.25rem; font-size: 0.75rem; margin-top: 0.25rem; border-radius: 0.25rem; display: flex; align-items: center; justify-content: center; font-weight: 500; 
                                        {% if game.draw_ev and game.draw_ev > 0 %}background-color: #059669; color: white;
                                        {% elif game.draw_ev and game.draw_ev < 0 %}background-color: #dc2626; color: white;
                                        {% else %}background-color: #eab308; color: white;{% endif %}">
                                        {% if game.draw_ev %}{{ '+' if game.draw_ev >= 0 else '' }}{{ (game.draw_ev * 100)|round(1) }}%{% else %}-{% endif %}
                                    </div>
                                </div>
                                
                                <!-- Away -->
                                <div style="background-color: rgba(229, 231, 235, 0.3); border-radius: 0.375rem; padding: 0.5rem;">
                                    <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 0.25rem;">Away</div>
                                    <div style="font-weight: 600; font-size: 0.875rem;">{{ game.odds.away if game.odds.away else '-' }}</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">{{ (game.away_win_prob * 100)|round(0) if game.away_win_prob else '-' }}%</div>
                                    <div style="width: 100%; height: 1.25rem; font-size: 0.75rem; margin-top: 0.25rem; border-radius: 0.25rem; display: flex; align-items: center; justify-content: center; font-weight: 500; 
                                        {% if game.away_win_ev and game.away_win_ev > 0 %}background-color: #059669; color: white;
                                        {% elif game.away_win_ev and game.away_win_ev < 0 %}background-color: #dc2626; color: white;
                                        {% else %}background-color: #eab308; color: white;{% endif %}">
                                        {% if game.away_win_ev %}{{ '+' if game.away_win_ev >= 0 else '' }}{{ (game.away_win_ev * 100)|round(1) }}%{% else %}-{% endif %}
                                    </div>
                                </div>
                            </div>

                            <div style="display: flex; align-items: center; justify-content: space-between; font-size: 0.75rem; color: #6b7280; padding-top: 0.5rem; border-top: 1px solid #f3f4f6;">
                                <div style="display: flex; align-items: center; gap: 0.25rem;">
                                    <svg style="width: 0.75rem; height: 0.75rem;" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                    </svg>
                                    {{ game.id }}
                                </div>
                                <div>{{ game.model_name|default('Unknown Model') }}</div>
                            </div>
                        </div>

                        <!-- Desktop Layout -->
                        <div style="display: none; padding: 1rem;" class="desktop-layout">
                            <div style="display: grid; grid-template-columns: 1fr 1.5fr 0.8fr; gap: 1rem; align-items: center;">
                                <!-- Match Info -->
                                <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                                    <div style="font-weight: 600; color: #111827;">
                                        {{ game.display_home_team|default(game.home_team|default('Home Team')) }} vs {{ game.display_away_team|default(game.away_team|default('Away Team')) }}
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="display: inline-block; padding: 0.125rem 0.5rem; background-color: #f3f4f6; color: #374151; border-radius: 0.25rem; font-size: 0.75rem;">
                                            {{ game.display_league|default(game.league|default('Unknown League')) }}
                                        </span>
                                        <div style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.75rem; color: #6b7280;">
                                            <svg style="width: 0.75rem; height: 0.75rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                            {{ game.match_time.strftime('%b %d, %H:%M') }}
                                        </div>
                                    </div>
                                </div>

                                <!-- Outcomes -->
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; text-align: center;">
                                    <!-- Home -->
                                    <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                                        <div style="font-size: 0.75rem; color: #6b7280;">Home</div>
                                        <div style="font-weight: 600;">{{ game.odds.home if game.odds.home else '-' }}</div>
                                        <div style="font-size: 0.75rem; color: #6b7280;">{{ (game.home_win_prob * 100)|round(0) if game.home_win_prob else '-' }}%</div>
                                        <div style="width: 100%; height: 1.5rem; font-size: 0.75rem; border-radius: 0.25rem; display: flex; align-items: center; justify-content: center; font-weight: 500; 
                                            {% if game.home_win_ev and game.home_win_ev > 0 %}background-color: #059669; color: white;
                                            {% elif game.home_win_ev and game.home_win_ev < 0 %}background-color: #dc2626; color: white;
                                            {% else %}background-color: #eab308; color: white;{% endif %}">
                                            {% if game.home_win_ev %}{{ '+' if game.home_win_ev >= 0 else '' }}{{ (game.home_win_ev * 100)|round(1) }}%{% else %}-{% endif %}
                                        </div>
                                    </div>
                                    
                                    <!-- Draw -->
                                    <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                                        <div style="font-size: 0.75rem; color: #6b7280;">Draw</div>
                                        <div style="font-weight: 600;">{{ game.odds.draw if game.odds.draw else '-' }}</div>
                                        <div style="font-size: 0.75rem; color: #6b7280;">{{ (game.draw_prob * 100)|round(0) if game.draw_prob else '-' }}%</div>
                                        <div style="width: 100%; height: 1.5rem; font-size: 0.75rem; border-radius: 0.25rem; display: flex; align-items: center; justify-content: center; font-weight: 500; 
                                            {% if game.draw_ev and game.draw_ev > 0 %}background-color: #059669; color: white;
                                            {% elif game.draw_ev and game.draw_ev < 0 %}background-color: #dc2626; color: white;
                                            {% else %}background-color: #eab308; color: white;{% endif %}">
                                            {% if game.draw_ev %}{{ '+' if game.draw_ev >= 0 else '' }}{{ (game.draw_ev * 100)|round(1) }}%{% else %}-{% endif %}
                                        </div>
                                    </div>
                                    
                                    <!-- Away -->
                                    <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                                        <div style="font-size: 0.75rem; color: #6b7280;">Away</div>
                                        <div style="font-weight: 600;">{{ game.odds.away if game.odds.away else '-' }}</div>
                                        <div style="font-size: 0.75rem; color: #6b7280;">{{ (game.away_win_prob * 100)|round(0) if game.away_win_prob else '-' }}%</div>
                                        <div style="width: 100%; height: 1.5rem; font-size: 0.75rem; border-radius: 0.25rem; display: flex; align-items: center; justify-content: center; font-weight: 500; 
                                            {% if game.away_win_ev and game.away_win_ev > 0 %}background-color: #059669; color: white;
                                            {% elif game.away_win_ev and game.away_win_ev < 0 %}background-color: #dc2626; color: white;
                                            {% else %}background-color: #eab308; color: white;{% endif %}">
                                            {% if game.away_win_ev %}{{ '+' if game.away_win_ev >= 0 else '' }}{{ (game.away_win_ev * 100)|round(1) }}%{% else %}-{% endif %}
                                        </div>
                                    </div>
                                </div>

                                <!-- Meta Info -->
                                <div style="text-align: right; display: flex; flex-direction: column; gap: 0.25rem;">
                                    <div style="font-size: 0.75rem; color: #6b7280;">{{ game.model_name|default('Unknown Model') }}</div>
                                    <div style="display: flex; align-items: center; justify-content: flex-end; gap: 0.25rem; font-size: 0.75rem; color: #6b7280;">
                                        <svg style="width: 0.75rem; height: 0.75rem;" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                        </svg>
                                        {{ game.id }}
                                    </div>
                                    {% if game.home_win_is_profitable or game.draw_is_profitable or game.away_win_is_profitable %}
                                    <span style="display: inline-block; padding: 0.125rem 0.5rem; background-color: rgba(5, 150, 105, 0.1); color: #059669; border: 1px solid rgba(5, 150, 105, 0.2); border-radius: 0.25rem; font-size: 0.75rem;">
                                        Profitable
                                    </span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Pagination -->
                {% if total_pages is defined and total_pages > 1 %}
                <nav style="margin-top: 2rem; display: flex; justify-content: center;">
                    <ul style="display: flex; list-style: none; margin: 0; padding: 0; gap: 0.25rem;">
                        <li>
                            <a href="{{ url_for('all_predictions', page=page-1 if page > 1 else page, per_page=per_page, league=selected_league, model_type=selected_model, game_id=selected_game_id, lang=selected_language) }}" 
                               style="display: flex; align-items: center; justify-content: center; width: 2rem; height: 2rem; border: 1px solid #d1d5db; border-radius: 0.375rem; text-decoration: none; color: {% if page <= 1 %}#9ca3af{% else %}#374151{% endif %}; {% if page <= 1 %}pointer-events: none;{% endif %}">
                                &laquo;
                            </a>
                        </li>
                        
                        {% set start_page = [1, page - 2]|max %}
                        {% set end_page = [start_page + 4, total_pages|default(1)]|min %}
                        {% set start_page = [end_page - 4, 1]|max %}
                        
                        {% if start_page > 1 %}
                            <li>
                                <a href="{{ url_for('all_predictions', page=1, per_page=per_page, league=selected_league, model_type=selected_model, game_id=selected_game_id, lang=selected_language) }}"
                                   style="display: flex; align-items: center; justify-content: center; width: 2rem; height: 2rem; border: 1px solid #d1d5db; border-radius: 0.375rem; text-decoration: none; color: #374151;">1</a>
                            </li>
                            {% if start_page > 2 %}
                                <li style="display: flex; align-items: center; justify-content: center; width: 2rem; height: 2rem; color: #9ca3af;">...</li>
                            {% endif %}
                        {% endif %}
                        
                        {% for p in range(start_page, end_page + 1) %}
                            <li>
                                <a href="{{ url_for('all_predictions', page=p, per_page=per_page, league=selected_league, model_type=selected_model, game_id=selected_game_id, lang=selected_language) }}"
                                   style="display: flex; align-items: center; justify-content: center; width: 2rem; height: 2rem; border: 1px solid #d1d5db; border-radius: 0.375rem; text-decoration: none; {% if p == page %}background-color: #3b82f6; color: white; border-color: #3b82f6;{% else %}color: #374151;{% endif %}">{{ p }}</a>
                            </li>
                        {% endfor %}
                        
                        {% if end_page < total_pages|default(1) %}
                            {% if end_page < total_pages|default(1) - 1 %}
                                <li style="display: flex; align-items: center; justify-content: center; width: 2rem; height: 2rem; color: #9ca3af;">...</li>
                            {% endif %}
                            <li>
                                <a href="{{ url_for('all_predictions', page=total_pages|default(1), per_page=per_page, league=selected_league, model_type=selected_model, game_id=selected_game_id, lang=selected_language) }}"
                                   style="display: flex; align-items: center; justify-content: center; width: 2rem; height: 2rem; border: 1px solid #d1d5db; border-radius: 0.375rem; text-decoration: none; color: #374151;">{{ total_pages|default(1) }}</a>
                            </li>
                        {% endif %}
                        
                        <li>
                            <a href="{{ url_for('all_predictions', page=page+1 if page < total_pages else page, per_page=per_page, league=selected_league, model_type=selected_model, game_id=selected_game_id, lang=selected_language) }}"
                               style="display: flex; align-items: center; justify-content: center; width: 2rem; height: 2rem; border: 1px solid #d1d5db; border-radius: 0.375rem; text-decoration: none; color: {% if page >= total_pages %}#9ca3af{% else %}#374151{% endif %}; {% if page >= total_pages %}pointer-events: none;{% endif %}">
                                &raquo;
                            </a>
                        </li>
                    </ul>
                </nav>
                {% endif %}
                
                {% endif %}
            {% else %}
                <div style="text-align: center; padding: 4rem 0;">
                    <svg style="width: 4rem; height: 4rem; margin: 0 auto 1rem; color: #d1d5db;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <h3 style="font-size: 1.125rem; font-weight: 500; color: #111827; margin: 0 0 0.5rem 0;">No predictions found</h3>
                    <p style="color: #6b7280; margin: 0;">Try adjusting your filters to see more results.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Show mobile layout by default */
.mobile-layout {
    display: block;
}
.desktop-layout {
    display: none;
}

/* Switch to desktop layout on larger screens */
@media (min-width: 768px) {
    .mobile-layout {
        display: none;
    }
    .desktop-layout {
        display: block;
    }
}

/* Responsive adjustments */
@media (max-width: 640px) {
    .container {
        padding-left: 1rem;
        padding-right: 1rem;
    }
    
    /* Stack stats vertically on small screens */
    .stats-header {
        flex-direction: column;
        gap: 1rem;
    }
    
    .stats-item {
        text-align: center;
    }
}

/* Hover effects */
a:hover {
    opacity: 0.8;
}

button:hover {
    opacity: 0.9;
}

select:focus, input:focus {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
}
</style>

{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Handle form submission for filters
    const filterForm = document.getElementById('filterForm');
    if (filterForm) {
        // Auto-submit on select change
        const selects = filterForm.querySelectorAll('select');
        selects.forEach(select => {
            select.addEventListener('change', function() {
                filterForm.submit();
            });
        });
        
        // Handle search input with debounce
        const gameIdInput = filterForm.querySelector('input[name="game_id"]');
        if (gameIdInput) {
            let debounceTimer;
            gameIdInput.addEventListener('input', function() {
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    filterForm.submit();
                }, 500);
            });
        }
    }
    
    // Add loading state to form submission
    if (filterForm) {
        filterForm.addEventListener('submit', function() {
            const submitBtn = filterForm.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.innerHTML = 'Loading...';
                submitBtn.disabled = true;
            }
        });
    }
});
</script>
{% endblock %} 